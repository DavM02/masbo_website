var Rt=i=>{throw TypeError(i)};var Z=(i,e,t)=>e.has(i)||Rt("Cannot "+t);var s=(i,e,t)=>(Z(i,e,"read from private field"),t?t.call(i):e.get(i)),y=(i,e,t)=>e.has(i)?Rt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),l=(i,e,t,r)=>(Z(i,e,"write to private field"),r?r.call(i,t):e.set(i,t),t),p=(i,e,t)=>(Z(i,e,"access private method"),t);import{v as _t,w as vt,x as E,z as $,B as W,C as tt,G as et,H as mt,I as kt,J as X,K as Dt,N as Lt,O as wt,P as Qt,Q as Ot,R as qt,T as Ct,y as Et,U as Mt,i as jt,V as At,q as Bt,W as Y,X as ut,Y as lt,Z as dt,_ as pt,a0 as Ht,a1 as Ft}from"./index-DOLyxyMI.js";var m,a,z,b,S,D,T,Q,K,L,M,_,k,q,j,o,H,st,it,rt,nt,at,ot,ht,Pt,Ut,Wt=(Ut=class extends _t{constructor(e,t){super();y(this,o);y(this,m);y(this,a);y(this,z);y(this,b);y(this,S);y(this,D);y(this,T);y(this,Q);y(this,K);y(this,L);y(this,M);y(this,_);y(this,k);y(this,q);y(this,j,new Set);this.options=t,l(this,m,e),l(this,Q,null),l(this,T,vt()),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(s(this,a).addObserver(this),xt(s(this,a),this.options)?p(this,o,H).call(this):this.updateResult(),p(this,o,nt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ct(s(this,a),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ct(s(this,a),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,p(this,o,at).call(this),p(this,o,ot).call(this),s(this,a).removeObserver(this)}setOptions(e){const t=this.options,r=s(this,a);if(this.options=s(this,m).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof E(this.options.enabled,s(this,a))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");p(this,o,ht).call(this),s(this,a).setOptions(this.options),t._defaulted&&!$(this.options,t)&&s(this,m).getQueryCache().notify({type:"observerOptionsUpdated",query:s(this,a),observer:this});const c=this.hasListeners();c&&It(s(this,a),r,this.options,t)&&p(this,o,H).call(this),this.updateResult(),!c||s(this,a)===r&&E(this.options.enabled,s(this,a))===E(t.enabled,s(this,a))&&W(this.options.staleTime,s(this,a))===W(t.staleTime,s(this,a))||p(this,o,st).call(this);const h=p(this,o,it).call(this);!c||s(this,a)===r&&E(this.options.enabled,s(this,a))===E(t.enabled,s(this,a))&&h===s(this,q)||p(this,o,rt).call(this,h)}getOptimisticResult(e){const t=s(this,m).getQueryCache().build(s(this,m),e),r=this.createResult(t,e);return(function(c,h){return!$(c.getCurrentResult(),h)})(this,r)&&(l(this,b,r),l(this,D,this.options),l(this,S,s(this,a).state)),r}getCurrentResult(){return s(this,b)}trackResult(e,t){return new Proxy(e,{get:(r,c)=>(this.trackProp(c),t==null||t(c),c==="promise"&&(this.trackProp("data"),this.options.experimental_prefetchInRender||s(this,T).status!=="pending"||s(this,T).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,c))})}trackProp(e){s(this,j).add(e)}getCurrentQuery(){return s(this,a)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=s(this,m).defaultQueryOptions(e),r=s(this,m).getQueryCache().build(s(this,m),t);return r.fetch().then((()=>this.createResult(r,t)))}fetch(e){return p(this,o,H).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then((()=>(this.updateResult(),s(this,b))))}createResult(e,t){var bt;const r=s(this,a),c=this.options,h=s(this,b),u=s(this,S),w=s(this,D),G=e!==r?e.state:s(this,z),{state:g}=e;let d,f={...g},F=!1;if(t._optimisticResults){const C=this.hasListeners(),B=!C&&xt(e,t),J=C&&It(e,r,t,c);(B||J)&&(f={...f,...Lt(g.data,e.options)}),t._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:A,errorUpdatedAt:P,status:x}=f;d=f.data;let n=!1;if(t.placeholderData!==void 0&&d===void 0&&x==="pending"){let C;h!=null&&h.isPlaceholderData&&t.placeholderData===(w==null?void 0:w.placeholderData)?(C=h.data,n=!0):C=typeof t.placeholderData=="function"?t.placeholderData((bt=s(this,M))==null?void 0:bt.state.data,s(this,M)):t.placeholderData,C!==void 0&&(x="success",d=wt(h==null?void 0:h.data,C,t),F=!0)}if(t.select&&d!==void 0&&!n)if(h&&d===(u==null?void 0:u.data)&&t.select===s(this,K))d=s(this,L);else try{l(this,K,t.select),d=t.select(d),d=wt(h==null?void 0:h.data,d,t),l(this,L,d),l(this,Q,null)}catch(C){l(this,Q,C)}s(this,Q)&&(A=s(this,Q),d=s(this,L),P=Date.now(),x="error");const R=f.fetchStatus==="fetching",v=x==="pending",O=x==="error",I=v&&R,yt=d!==void 0,U={status:x,fetchStatus:f.fetchStatus,isPending:v,isSuccess:x==="success",isError:O,isInitialLoading:I,isLoading:I,data:d,dataUpdatedAt:f.dataUpdatedAt,error:A,errorUpdatedAt:P,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>G.dataUpdateCount||f.errorUpdateCount>G.errorUpdateCount,isFetching:R,isRefetching:R&&!v,isLoadingError:O&&!yt,isPaused:f.fetchStatus==="paused",isPlaceholderData:F,isRefetchError:O&&yt,isStale:ft(e,t),refetch:this.refetch,promise:s(this,T),isEnabled:E(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const C=U.data!==void 0,B=U.status==="error"&&!C,J=V=>{B?V.reject(U.error):C&&V.resolve(U.data)},gt=()=>{const V=l(this,T,U.promise=vt());J(V)},N=s(this,T);switch(N.status){case"pending":e.queryHash===r.queryHash&&J(N);break;case"fulfilled":(B||U.data!==N.value)&&gt();break;case"rejected":B&&U.error===N.reason||gt()}}return U}updateResult(){const e=s(this,b),t=this.createResult(s(this,a),this.options);l(this,S,s(this,a).state),l(this,D,this.options),s(this,S).data!==void 0&&l(this,M,s(this,a)),!$(t,e)&&(l(this,b,t),p(this,o,Pt).call(this,{listeners:(()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,c=typeof r=="function"?r():r;if(c==="all"||!c&&!s(this,j).size)return!0;const h=new Set(c??s(this,j));return this.options.throwOnError&&h.add("error"),Object.keys(s(this,b)).some((u=>{const w=u;return s(this,b)[w]!==e[w]&&h.has(w)}))})()}))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&p(this,o,nt).call(this)}},m=new WeakMap,a=new WeakMap,z=new WeakMap,b=new WeakMap,S=new WeakMap,D=new WeakMap,T=new WeakMap,Q=new WeakMap,K=new WeakMap,L=new WeakMap,M=new WeakMap,_=new WeakMap,k=new WeakMap,q=new WeakMap,j=new WeakMap,o=new WeakSet,H=function(e){p(this,o,ht).call(this);let t=s(this,a).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(tt)),t},st=function(){p(this,o,at).call(this);const e=W(this.options.staleTime,s(this,a));if(et||s(this,b).isStale||!mt(e))return;const t=kt(s(this,b).dataUpdatedAt,e)+1;l(this,_,X.setTimeout((()=>{s(this,b).isStale||this.updateResult()}),t))},it=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(s(this,a)):this.options.refetchInterval)??!1},rt=function(e){p(this,o,ot).call(this),l(this,q,e),!et&&E(this.options.enabled,s(this,a))!==!1&&mt(s(this,q))&&s(this,q)!==0&&l(this,k,X.setInterval((()=>{(this.options.refetchIntervalInBackground||Dt.isFocused())&&p(this,o,H).call(this)}),s(this,q)))},nt=function(){p(this,o,st).call(this),p(this,o,rt).call(this,p(this,o,it).call(this))},at=function(){s(this,_)&&(X.clearTimeout(s(this,_)),l(this,_,void 0))},ot=function(){s(this,k)&&(X.clearInterval(s(this,k)),l(this,k,void 0))},ht=function(){const e=s(this,m).getQueryCache().build(s(this,m),this.options);if(e===s(this,a))return;const t=s(this,a);l(this,a,e),l(this,z,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},Pt=function(e){Qt.batch((()=>{e.listeners&&this.listeners.forEach((t=>{t(s(this,b))})),s(this,m).getQueryCache().notify({query:s(this,a),type:"observerResultsUpdated"})}))},Ut);function xt(i,e){return(function(t,r){return E(r.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&r.retryOnMount===!1)})(i,e)||i.state.data!==void 0&&ct(i,e,e.refetchOnMount)}function ct(i,e,t){if(E(e.enabled,i)!==!1&&W(e.staleTime,i)!=="static"){const r=typeof t=="function"?t(i):t;return r==="always"||r!==!1&&ft(i,e)}return!1}function It(i,e,t,r){return(i!==e||E(r.enabled,i)===!1)&&(!t.suspense||i.state.status!=="error")&&ft(i,t)}function ft(i,e){return E(e.enabled,i)!==!1&&i.isStaleByTime(W(e.staleTime,i))}var St=qt(!1);St.Provider;var zt=qt((function(){let i=!1;return{clearReset:()=>{i=!1},reset:()=>{i=!0},isReset:()=>i}})()),Tt=(i,e,t)=>e.fetchOptimistic(i).catch((()=>{t.clearReset()}));function Kt(i,e,t){var F,A,P,x;const r=Ot(St),c=Ot(zt),h=Mt(),u=h.defaultQueryOptions(i);(A=(F=h.getDefaultOptions().queries)==null?void 0:F._experimental_beforeQuery)==null||A.call(F,u);const w=h.getQueryCache().get(u.queryHash);u._optimisticResults=r?"isRestoring":"optimistic",(n=>{if(n.suspense){const v=I=>I==="static"?I:Math.max(I??1e3,1e3),O=n.staleTime;n.staleTime=typeof O=="function"?(...I)=>v(O(...I)):v(O),typeof n.gcTime=="number"&&(n.gcTime=Math.max(n.gcTime,1e3))}})(u),((n,R,v)=>{const O=v!=null&&v.state.error&&typeof n.throwOnError=="function"?Ct(n.throwOnError,[v.state.error,v]):n.throwOnError;(n.suspense||n.experimental_prefetchInRender||O)&&(R.isReset()||(n.retryOnMount=!1))})(u,c,w),(n=>{Et((()=>{n.clearReset()}),[n])})(c);const G=!h.getQueryCache().get(u.queryHash),[g]=jt((()=>new e(h,u))),d=g.getOptimisticResult(u),f=!r&&i.subscribed!==!1;if(At(Bt((n=>{const R=f?g.subscribe(Qt.batchCalls(n)):tt;return g.updateResult(),R}),[g,f]),(()=>g.getCurrentResult())),Et((()=>{g.setOptions(u)}),[u,g]),((n,R)=>(n==null?void 0:n.suspense)&&R.isPending)(u,d))throw Tt(u,g,c);if((({result:n,errorResetBoundary:R,throwOnError:v,query:O,suspense:I})=>n.isError&&!R.isReset()&&!n.isFetching&&O&&(I&&n.data===void 0||Ct(v,[n.error,O])))({result:d,errorResetBoundary:c,throwOnError:u.throwOnError,query:w,suspense:u.suspense}))throw d.error;if((x=(P=h.getDefaultOptions().queries)==null?void 0:P._experimental_afterQuery)==null||x.call(P,u,d),u.experimental_prefetchInRender&&!et&&((n,R)=>n.isLoading&&n.isFetching&&!R)(d,r)){const n=G?Tt(u,g,c):w==null?void 0:w.promise;n==null||n.catch(tt).finally((()=>{g.updateResult()}))}return u.notifyOnChangeProps?d:g.trackResult(d)}function Nt(i,e,t={}){return(function(r){return Kt(r,Wt)})({queryKey:[i],queryFn:async()=>{if(typeof e=="function")return await e();{const r=await fetch(e);if(!r.ok)throw new Error(`Failed to fetch: ${r.statusText}`);return await r.json()}},staleTime:1/0,cacheTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchInterval:!1,...t})}async function Vt(i,e){try{const t=lt(dt,i),r=e&&e!=="all"?await Y(ut(t,pt("category"),Ft(e))):await Y(t);return r.exists()?Object.values(r.val()):[]}catch(t){throw console.error("Error loading data:",t),t}}async function Xt([i,e]){if(!i)throw new Error("Id is required");try{const t=lt(dt,e),r=ut(t,pt("id"),Ft(i)),c=await Y(r);if(c.exists()){const h=c.val();return Object.values(h)[0]}return null}catch{throw new Error("An unexpected error occurred")}}async function Yt(i="blog",e=3){if(!i)throw new Error("Path is required");try{const t=await Y(ut(lt(dt,i),pt("id"),Ht(e)));return t.exists()?Object.values(t.val()).reverse():[]}catch(t){throw console.error("Error loading latest news:",t),t}}export{Yt as a,Xt as g,Vt as l,Nt as u};
